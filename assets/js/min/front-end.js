!function(){var e,n,t;!function(i){function o(e,n){return b.call(e,n)}function r(e,n){var t,i,o,r,l,c,s,u,a,f,d,h=n&&n.split("/"),g=y.map,p=g&&g["*"]||{};if(e&&"."===e.charAt(0))if(n){for(e=e.split("/"),l=e.length-1,y.nodeIdCompat&&O.test(e[l])&&(e[l]=e[l].replace(O,"")),e=h.slice(0,h.length-1).concat(e),a=0;a<e.length;a+=1)if(d=e[a],"."===d)e.splice(a,1),a-=1;else if(".."===d){if(1===a&&(".."===e[2]||".."===e[0]))break;a>0&&(e.splice(a-1,2),a-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((h||p)&&g){for(t=e.split("/"),a=t.length;a>0;a-=1){if(i=t.slice(0,a).join("/"),h)for(f=h.length;f>0;f-=1)if(o=g[h.slice(0,f).join("/")],o&&(o=o[i])){r=o,c=a;break}if(r)break;!s&&p&&p[i]&&(s=p[i],u=a)}!r&&s&&(r=s,c=u),r&&(t.splice(0,c,r),e=t.join("/"))}return e}function l(e,n){return function(){var t=M.call(arguments,0);return"string"!=typeof t[0]&&1===t.length&&t.push(null),h.apply(i,t.concat([e,n]))}}function c(e){return function(n){return r(n,e)}}function s(e){return function(n){v[e]=n}}function u(e){if(o(m,e)){var n=m[e];delete m[e],w[e]=!0,d.apply(i,n)}if(!o(v,e)&&!o(w,e))throw new Error("No "+e);return v[e]}function a(e){var n,t=e?e.indexOf("!"):-1;return t>-1&&(n=e.substring(0,t),e=e.substring(t+1,e.length)),[n,e]}function f(e){return function(){return y&&y.config&&y.config[e]||{}}}var d,h,g,p,v={},m={},y={},w={},b=Object.prototype.hasOwnProperty,M=[].slice,O=/\.js$/;g=function(e,n){var t,i=a(e),o=i[0];return e=i[1],o&&(o=r(o,n),t=u(o)),o?e=t&&t.normalize?t.normalize(e,c(n)):r(e,n):(e=r(e,n),i=a(e),o=i[0],e=i[1],o&&(t=u(o))),{f:o?o+"!"+e:e,n:e,pr:o,p:t}},p={require:function(e){return l(e)},exports:function(e){var n=v[e];return"undefined"!=typeof n?n:v[e]={}},module:function(e){return{id:e,uri:"",exports:v[e],config:f(e)}}},d=function(e,n,t,r){var c,a,f,d,h,y,b=[],M=typeof t;if(r=r||e,"undefined"===M||"function"===M){for(n=!n.length&&t.length?["require","exports","module"]:n,h=0;h<n.length;h+=1)if(d=g(n[h],r),a=d.f,"require"===a)b[h]=p.require(e);else if("exports"===a)b[h]=p.exports(e),y=!0;else if("module"===a)c=b[h]=p.module(e);else if(o(v,a)||o(m,a)||o(w,a))b[h]=u(a);else{if(!d.p)throw new Error(e+" missing "+a);d.p.load(d.n,l(r,!0),s(a),{}),b[h]=v[a]}f=t?t.apply(v[e],b):void 0,e&&(c&&c.exports!==i&&c.exports!==v[e]?v[e]=c.exports:f===i&&y||(v[e]=f))}else e&&(v[e]=t)},e=n=h=function(e,n,t,o,r){if("string"==typeof e)return p[e]?p[e](n):u(g(e,n).f);if(!e.splice){if(y=e,y.deps&&h(y.deps,y.callback),!n)return;n.splice?(e=n,n=t,t=null):e=i}return n=n||function(){},"function"==typeof t&&(t=o,o=r),o?d(i,e,n,t):setTimeout(function(){d(i,e,n,t)},4),h},h.config=function(e){return h(e)},e._defined=v,t=function(e,n,t){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");n.splice||(t=n,n=[]),o(v,e)||o(m,e)||(m[e]=[e,n,t])},t.amd={jQuery:!0}}(),t("../lib/almond",function(){}),t("models/whenModel",[],function(){var e=Backbone.Model.extend({initialize:function(e,n){var t=i.channel("form-"+n.condition.collection.formModel.get("id")).request("get:fieldByKey",this.get("key"));t.on("change:value",this.updateCompare,this),this.listenTo(i.channel("field-"+t.get("id")),"keyup:field",this.maybeUpdateCompare),this.updateCompare(t),t.on("change:visible",this.updateCompare,this)},maybeUpdateCompare:function(e,n,t){var i=jQuery(e).val();this.updateCompare(n,null,i)},updateCompare:function(e,n,t){_.isEmpty(t)&&(t=e.get("value"));var i=this.compareValues[this.get("comparator")](t,this.get("value"));this.set("status",i),e.get("visible")||this.set("status",!1)},compareValues:{equal:function(e,n){return e==n},notequal:function(e,n){return e!=n},contains:function(e,n){return jQuery.isArray(e)?e.indexOf(n)>=0:n.indexOf('"')>=0?(n=n.replace(/['"]+/g,""),new RegExp("\\b"+n+"\\b").test(e)):e.toLowerCase().indexOf(n.toLowerCase())>=0},notcontains:function(e,n){return!this.contains(e,n)},greater:function(e,n){return parseFloat(e)>parseFloat(n)},less:function(e,n){return parseFloat(e)<parseFloat(n)}}});return e}),t("models/whenCollection",["models/whenModel"],function(e){var n=Backbone.Collection.extend({model:e,initialize:function(e,n){}});return n}),t("models/conditionModel",["models/whenCollection"],function(e){var n=Backbone.Model.extend({initialize:function(n){this.set("when",new e(this.get("when"),{condition:this})),this.get("when").on("change:status",this.checkWhen,this),this.checkWhen()},checkWhen:function(){var e=this.get("when").pluck("status"),n=this.get("when").pluck("connector"),t=_.every(_.values(n),function(e){return"AND"==e},this);if(t)var o=_.every(_.values(e),function(e){return e},this);else var o=_.some(_.values(e),function(e){return e},this);o?_.each(this.get("then"),function(e,n){i.channel("condition:trigger").request(e.trigger,this,e)},this):_.each(this.get("else"),function(e,n){i.channel("condition:trigger").request(e.trigger,this,e)},this)}});return n}),t("models/conditionCollection",["models/conditionModel"],function(e){var n=Backbone.Collection.extend({model:e,initialize:function(e,n){this.formModel=n.formModel}});return n}),t("controllers/initCollection",["models/conditionCollection"],function(e){var n=Marionette.Object.extend({initialize:function(n){new e(n.get("conditions"),{formModel:n})}});return n}),t("controllers/showHide",[],function(){var e=Marionette.Object.extend({initialize:function(){i.channel("condition:trigger").reply("hide_field",this.hideField,this),i.channel("condition:trigger").reply("show_field",this.showField,this)},hideField:function(e,n){var t=i.channel("form-"+e.collection.formModel.get("id")).request("get:fieldByKey",n.key);t.set("visible",!1),t.trigger("change:value",t),i.channel("fields").request("remove:error",t.get("id"),"required-error")},showField:function(e,n){var t=i.channel("form-"+e.collection.formModel.get("id")).request("get:fieldByKey",n.key);t.set("visible",!0),t.trigger("change:value",t)}});return e}),t("controllers/showHideOption",[],function(){var e=Marionette.Object.extend({initialize:function(){i.channel("condition:trigger").reply("show_option",this.showOption,this),i.channel("condition:trigger").reply("hide_option",this.hideOption,this)},showOption:function(e,n){var t=this.getOption(e,n);t.visible=!0,this.updateFieldModel(e,n)},hideOption:function(e,n){var t=this.getOption(e,n);t.visible=!1,this.updateFieldModel(e,n)},getFieldModel:function(e,n){return i.channel("form-"+e.collection.formModel.get("id")).request("get:fieldByKey",n.key)},getOption:function(e,n){var t=this.getFieldModel(e,n),i=t.get("options");return _.find(i,function(e){return e.value==n.value})},updateFieldModel:function(e,n){var t=this.getFieldModel(e,n),i=t.get("options");t.set("options",i),t.trigger("reRender")}});return e}),t("controllers/changeValue",[],function(){var e=Marionette.Object.extend({initialize:function(){i.channel("condition:trigger").reply("change_value",this.changeValue,this)},changeValue:function(e,n){var t=i.channel("form-"+e.collection.formModel.get("id")).request("get:fieldByKey",n.key);t.set("value",n.value),t.trigger("reRender",t)}});return e}),t("controllers/selectDeselect",[],function(){var e=Marionette.Object.extend({initialize:function(){i.channel("condition:trigger").reply("select_option",this.selectOption,this),i.channel("condition:trigger").reply("deselect_option",this.deselectOption,this)},selectOption:function(e,n){var t=_.clone(n);t.value=[t.value],i.channel("condition:trigger").request("change_value",e,t)},deselectOption:function(e,n){var t=i.channel("form-"+e.collection.formModel.get("id")).request("get:fieldByKey",n.key),o=t.get("value");o=_.without(o,n.value),t.set("value",o),t.trigger("reRender",t)}});return e});var i=Backbone.Radio;n(["controllers/initCollection","controllers/showHide","controllers/showHideOption","controllers/changeValue","controllers/selectDeselect"],function(e,n,t,o,r){var l=Marionette.Application.extend({initialize:function(e){this.listenTo(i.channel("form"),"loaded",this.initCollection)},initCollection:function(i){new n,new t,new o,new r,new e(i)},onStart:function(){}}),c=new l;c.start()}),t("main",function(){})}();
//# sourceMappingURL=almond.build.js.map
//# sourceMappingURL=front-end.js.map
