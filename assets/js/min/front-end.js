!function(){var e,t,n;!function(i){function o(e,t){return b.call(e,t)}function r(e,t){var n,i,o,r,l,c,s,u,a,f,d,h=t&&t.split("/"),g=y.map,p=g&&g["*"]||{};if(e&&"."===e.charAt(0))if(t){for(e=e.split("/"),l=e.length-1,y.nodeIdCompat&&O.test(e[l])&&(e[l]=e[l].replace(O,"")),e=h.slice(0,h.length-1).concat(e),a=0;a<e.length;a+=1)if(d=e[a],"."===d)e.splice(a,1),a-=1;else if(".."===d){if(1===a&&(".."===e[2]||".."===e[0]))break;a>0&&(e.splice(a-1,2),a-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((h||p)&&g){for(n=e.split("/"),a=n.length;a>0;a-=1){if(i=n.slice(0,a).join("/"),h)for(f=h.length;f>0;f-=1)if(o=g[h.slice(0,f).join("/")],o&&(o=o[i])){r=o,c=a;break}if(r)break;!s&&p&&p[i]&&(s=p[i],u=a)}!r&&s&&(r=s,c=u),r&&(n.splice(0,c,r),e=n.join("/"))}return e}function l(e,t){return function(){var n=M.call(arguments,0);return"string"!=typeof n[0]&&1===n.length&&n.push(null),h.apply(i,n.concat([e,t]))}}function c(e){return function(t){return r(t,e)}}function s(e){return function(t){v[e]=t}}function u(e){if(o(m,e)){var t=m[e];delete m[e],w[e]=!0,d.apply(i,t)}if(!o(v,e)&&!o(w,e))throw new Error("No "+e);return v[e]}function a(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function f(e){return function(){return y&&y.config&&y.config[e]||{}}}var d,h,g,p,v={},m={},y={},w={},b=Object.prototype.hasOwnProperty,M=[].slice,O=/\.js$/;g=function(e,t){var n,i=a(e),o=i[0];return e=i[1],o&&(o=r(o,t),n=u(o)),o?e=n&&n.normalize?n.normalize(e,c(t)):r(e,t):(e=r(e,t),i=a(e),o=i[0],e=i[1],o&&(n=u(o))),{f:o?o+"!"+e:e,n:e,pr:o,p:n}},p={require:function(e){return l(e)},exports:function(e){var t=v[e];return"undefined"!=typeof t?t:v[e]={}},module:function(e){return{id:e,uri:"",exports:v[e],config:f(e)}}},d=function(e,t,n,r){var c,a,f,d,h,y,b=[],M=typeof n;if(r=r||e,"undefined"===M||"function"===M){for(t=!t.length&&n.length?["require","exports","module"]:t,h=0;h<t.length;h+=1)if(d=g(t[h],r),a=d.f,"require"===a)b[h]=p.require(e);else if("exports"===a)b[h]=p.exports(e),y=!0;else if("module"===a)c=b[h]=p.module(e);else if(o(v,a)||o(m,a)||o(w,a))b[h]=u(a);else{if(!d.p)throw new Error(e+" missing "+a);d.p.load(d.n,l(r,!0),s(a),{}),b[h]=v[a]}f=n?n.apply(v[e],b):void 0,e&&(c&&c.exports!==i&&c.exports!==v[e]?v[e]=c.exports:f===i&&y||(v[e]=f))}else e&&(v[e]=n)},e=t=h=function(e,t,n,o,r){if("string"==typeof e)return p[e]?p[e](t):u(g(e,t).f);if(!e.splice){if(y=e,y.deps&&h(y.deps,y.callback),!t)return;t.splice?(e=t,t=n,n=null):e=i}return t=t||function(){},"function"==typeof n&&(n=o,o=r),o?d(i,e,t,n):setTimeout(function(){d(i,e,t,n)},4),h},h.config=function(e){return h(e)},e._defined=v,n=function(e,t,n){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");t.splice||(n=t,t=[]),o(v,e)||o(m,e)||(m[e]=[e,t,n])},n.amd={jQuery:!0}}(),n("../lib/almond",function(){}),n("models/whenModel",[],function(){var e=Backbone.Model.extend({initialize:function(e,t){var n=i.channel("form-"+t.condition.collection.formModel.get("id")).request("get:fieldByKey",this.get("key"));n.on("change:value",this.updateCompare,this),this.listenTo(i.channel("field-"+n.get("id")),"keyup:field",this.maybeUpdateCompare),this.updateCompare(n),n.on("change:visible",this.updateCompare,this)},maybeUpdateCompare:function(e,t,n){var i=jQuery(e).val();this.updateCompare(t,null,i)},updateCompare:function(e,t,n){_.isEmpty(n)&&(n=e.get("value"));var i=this.compareValues[this.get("comparator")](n,this.get("value"));this.set("status",i),e.get("visible")||this.set("status",!1)},compareValues:{equal:function(e,t){return e==t},notequal:function(e,t){return e!=t},contains:function(e,t){return jQuery.isArray(e)?e.indexOf(t)>=0:t.indexOf('"')>=0?(t=t.replace(/['"]+/g,""),new RegExp("\\b"+t+"\\b").test(e)):e.toLowerCase().indexOf(t.toLowerCase())>=0},notcontains:function(e,t){return!this.contains(e,t)},greater:function(e,t){return parseFloat(e)>parseFloat(t)},less:function(e,t){return parseFloat(e)<parseFloat(t)}}});return e}),n("models/whenCollection",["models/whenModel"],function(e){var t=Backbone.Collection.extend({model:e,initialize:function(e,t){}});return t}),n("models/conditionModel",["models/whenCollection"],function(e){var t=Backbone.Model.extend({initialize:function(t){this.set("when",new e(this.get("when"),{condition:this})),this.get("when").on("change:status",this.checkWhen,this),this.checkWhen()},checkWhen:function(){var e=this.get("when").pluck("status"),t=this.get("when").pluck("connector"),n=_.every(_.values(t),function(e){return"AND"==e},this);if(n)var o=_.every(_.values(e),function(e){return e},this);else var o=_.some(_.values(e),function(e){return e},this);o?_.each(this.get("then"),function(e,t){i.channel("condition:trigger").request(e.trigger,this,e)},this):_.each(this.get("else"),function(e,t){i.channel("condition:trigger").request(e.trigger,this,e)},this)}});return t}),n("models/conditionCollection",["models/conditionModel"],function(e){var t=Backbone.Collection.extend({model:e,initialize:function(e,t){this.formModel=t.formModel}});return t}),n("controllers/initCollection",["models/conditionCollection"],function(e){var t=Marionette.Object.extend({initialize:function(t){new e(t.get("conditions"),{formModel:t})}});return t}),n("controllers/showHide",[],function(){var e=Marionette.Object.extend({initialize:function(){i.channel("condition:trigger").reply("hide_field",this.hideField,this),i.channel("condition:trigger").reply("show_field",this.showField,this)},hideField:function(e,t){var n=i.channel("form-"+e.collection.formModel.get("id")).request("get:fieldByKey",t.key);n.set("visible",!1),n.trigger("change:value",n),i.channel("fields").request("remove:error",n.get("id"),"required-error")},showField:function(e,t){var n=i.channel("form-"+e.collection.formModel.get("id")).request("get:fieldByKey",t.key);n.set("visible",!0),n.trigger("change:value",n)}});return e}),n("controllers/showHideOption",[],function(){var e=Marionette.Object.extend({initialize:function(){i.channel("condition:trigger").reply("show_option",this.showOption,this),i.channel("condition:trigger").reply("hide_option",this.hideOption,this)},showOption:function(e,t){var n=this.getOption(e,t);n.visible=!0,this.updateFieldModel(e,t)},hideOption:function(e,t){var n=this.getOption(e,t);n.visible=!1,this.updateFieldModel(e,t)},getFieldModel:function(e,t){return i.channel("form-"+e.collection.formModel.get("id")).request("get:fieldByKey",t.key)},getOption:function(e,t){var n=this.getFieldModel(e,t),i=n.get("options");return _.find(i,function(e){return e.value==t.value})},updateFieldModel:function(e,t){var n=this.getFieldModel(e,t),i=n.get("options");n.set("options",i),n.trigger("reRender")}});return e}),n("controllers/changeValue",[],function(){var e=Marionette.Object.extend({initialize:function(){i.channel("condition:trigger").reply("change_value",this.changeValue,this)},changeValue:function(e,t){var n=i.channel("form-"+e.collection.formModel.get("id")).request("get:fieldByKey",t.key);n.set("value",t.value),n.trigger("reRender",n)}});return e}),n("controllers/selectDeselect",[],function(){var e=Marionette.Object.extend({initialize:function(){i.channel("condition:trigger").reply("select_option",this.selectOption,this),i.channel("condition:trigger").reply("deselect_option",this.deselectOption,this)},selectOption:function(e,t){var n=i.channel("form-"+e.collection.formModel.get("id")).request("get:fieldByKey",t.key),o=n.get("options"),r=_.find(o,{value:t.value});r.selected=1,n.set("options",o),n.trigger("reRender",n)},deselectOption:function(e,t){var n=i.channel("form-"+e.collection.formModel.get("id")).request("get:fieldByKey",t.key),o=n.get("options"),r=_.find(o,{value:t.value});r.selected=0,n.set("options",o);var l=n.get("value");l=_.isArray(l)?_.without(l,t.value):"",n.set("value",l),n.trigger("reRender",n)}});return e});var i=Backbone.Radio;t(["controllers/initCollection","controllers/showHide","controllers/showHideOption","controllers/changeValue","controllers/selectDeselect"],function(e,t,n,o,r){var l=Marionette.Application.extend({initialize:function(e){this.listenTo(i.channel("form"),"loaded",this.initCollection)},initCollection:function(i){new t,new n,new o,new r,new e(i)},onStart:function(){}}),c=new l;c.start()}),n("main",function(){})}();
//# sourceMappingURL=almond.build.js.map
//# sourceMappingURL=front-end.js.map
